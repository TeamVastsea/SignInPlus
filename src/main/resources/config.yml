#########################################################
# SignInPlus Configuration (Default Example)
# Notes: This file contains all configurable options and default examples
# After editing, use /signinplus reload to apply changes
#########################################################

#########################################################
# Storage
# Notes
# - Options: sqlite / mysql / postgresql
# - Keys: database.type / database.url / database.username / database.password
# URL Formats
# - sqlite: signinplus.db
# - postgresql: 127.0.0.1:5432/signinplus?sslmode=disable
# - mysql: 127.0.0.1:3306/signinplus
# Auto-create
# - sqlite: creates plugins/SignInPlus/signinplus.db if missing
# - mysql/postgresql: attempts to create database signinplus (account needs create permission)
# Examples
# - postgresql: type=postgresql, url=127.0.0.1:5432/signinplus?sslmode=disable, username=local_pg, password=...
#########################################################
database:
  type: sqlite
  url: signinplus.db
  username:
  password:

#########################################################
# Auto sign-in
# Whether to sign in players automatically on login
#########################################################
auto_check_in_on_login:
  enable: false

#########################################################
# Basic settings
# message_prefix: plugin message prefix
# timezone: see https://www.zeitverschiebung.net/en/all-time-zones.html
# locale: language (zh_CN / en_US)
# bState: enable bStats metrics
# debug: enable debug mode (more logs)
#########################################################
message_prefix: "&7[&aSignInPlus&7] "
timezone: "Asia/Shanghai"
locale: en_US
bState: true
debug: false

#########################################################
# Default sign-in rewards
# Actions supported:
# - [COMMAND]   Execute command (supports %player_name%)
# - [SOUND]     Play sound [type volume pitch]
# - [ITEM]      Give item [item amount NBT]
# - [SLEEP]     Delay (ticks, 20 ticks = 1s)
# - [EFFECT]    Potion effect [type level seconds]
# - [MESSAGE]   Send message [message]
# - [TITLE]     Send title [title]
# - [BROADCAST] Broadcast message [message]
# - [POINTS]    Give points [amount format]
#
# Probability:
# - [PROB=X]    Trigger by chance [probability]
# - [RANDOM_WEIGHTED] Start weighted list
# - [WEIGHT=X]  Weight for one action
# - [/RANDOM_WEIGHTED] End weighted list
# - [RANDOM_PICK=X] Start mutually-exclusive random list
# - [/RANDOM_PICK] End mutually-exclusive random list
#########################################################
default:
  actions:
    # Basic examples
    - "[COMMAND] give %player_name% apple 64"
    - "[SOUND] ENTITY_PLAYER_LEVELUP 0.5 1.0"
    - "[ITEM] apple 64"
    - "[BROADCAST] %player_name% §6has signed in today!"
    - "[TITLE] §cSign-in successful!"
    - "[SLEEP] 20"
    - "[EFFECT] speed 2 10"

    # Item NBT
    # 1. ✅ Normal enchantment: a diamond sword with Unbreaking III
    - '[ITEM] DIAMOND_SWORD 1 {Enchantments:[{id:"minecraft:unbreaking",lvl:3s}]}'
    # 2. ✅ Complex NBT (custom name and lore): a special golden apple
    - '[ITEM] GOLDEN_APPLE 1 {"display":{"Name":"{\"text\":\"Life Golden Apple\",\"color\":\"gold\",\"italic\":false}","Lore":["{\"text\":\"A special apple!\",\"color\":\"yellow\"}"]}}'
    # 3. ✅ Complex NBT (book): a written book with title, author, and pages
    - '[ITEM] WRITTEN_BOOK 1 {title:"My Story",author:"Steve",pages:["{\"text\":\"Content of the first page.\"}","{\"text\":\"The second page is even better!\"}"]}'
    # 4. ⚠️ Invalid NBT: expected result is a normal stone and a console warning
    - "[ITEM] STONE 1 {invalid_nbt:true"
    # 5. ⚠️ Force fix: missing braces are fixed by force=true
    - '[ITEM] IRON_INGOT 1 "display":{"Name":"{\"text\":\"Force-fixed Iron Ingot\"}"} force=true'
    # 6. ✅ Empty NBT: gives a normal dirt
    - "[ITEM] DIRT 1 {}"

    # Points rewards
    - "[POINTS] 64"
    - "[POINTS] 64 z"
    - "[POINTS] 1..5 .2f"
    - "[POINTS] 1..5 .1f"
    - "[POINTS] 1..5 .3f"
    - "[POINTS] 1..5 z"

    # Chance rewards
    - "[PROB=0.25] [COMMAND] give %player_name% diamond 1"

    # Mutually-exclusive rewards
    - "[RANDOM_PICK=2]"
    - "[COMMAND] give %player_name% apple 10"
    - "[COMMAND] give %player_name% diamond 1"
    - "[COMMAND] give %player_name% emerald 5"
    - "[/RANDOM_PICK]"

    # Weighted rewards
    - "[RANDOM_WEIGHTED]"
    - "[WEIGHT=60] [COMMAND] give %player_name% apple 10"
    - "[WEIGHT=30] [COMMAND] give %player_name% diamond 1"
    - "[WEIGHT=10] [COMMAND] give %player_name% nether_star 1"
    - "[/RANDOM_WEIGHTED]"

    # Nested examples
    - "[PROB=0.5] [COMMAND] give %player_name% bread 1"
    - "[RANDOM_WEIGHTED]"
    - "[WEIGHT=80] [COMMAND] give %player_name% apple 5"
    - "[WEIGHT=15] [COMMAND] give %player_name% diamond 1"
    - "[WEIGHT=5] [COMMAND] give %player_name% netherite_ingot 1"
    - "[/RANDOM_WEIGHTED]"
    - "[SLEEP] 20"
    - "[MESSAGE] Congratulations on signing in!"

#########################################################
# Cumulative and streak rewards
# - enable: whether enabled
# - times: threshold
#########################################################
cumulative:
  - enable: false
  - times: 7
    actions:
      - "[COMMAND] give %player_name% iron_ingot 10"
      - "[MESSAGE] You have signed in 7 times and received 10 iron ingots!"
  - times: 30
    actions:
      - "[COMMAND] give %player_name% diamond 2"
      - "[TITLE] 30 total sign-ins|Reward: diamond x2"
  - times: 100
    actions:
      - "[COMMAND] give %player_name% nether_star 1"
      - "[BROADCAST] %player_name% reached 100 total sign-ins and received a legendary reward!"
streak:
  - enable: false
  - times: 3
    actions:
      - "[COMMAND] give %player_name% apple 5"
      - "[MESSAGE] 3-day streak! Enjoy 5 apples."
  - times: 7
    actions:
      - "[COMMAND] give %player_name% golden_apple 1"
      - "[MESSAGE] 7-day streak! Reward: 1 golden apple."

#########################################################
# Top rewards (extra rewards, not replacing default rewards)
# Based on daily sign-in rank
# - enable: whether enabled
# - rank: rank position
#########################################################
top:
  - enable: false
  - rank: 1
    actions:
      - "[COMMAND] give %player_name% apple 64"
  - rank: 2
    actions:
      - '[COMMAND] give %player_name% diamond_sword 1'
  - rank: 3
    actions:
      - "[COMMAND] give %player_name% emerald 64"

#########################################################
# Special date rewards
# - Supported: specific date / yearly / monthly / weekly
# - date: "yyyy-MM-dd" | "*-MM-dd" | "*-*-dd" | "Monday" | "Tuesday" | "Wednesday" | "Thursday" | "Friday" | "Saturday" | "Sunday"
# - repeat: allow repeating
# - repeat_time: repeat limit (only for repeat=true)
#########################################################
special_dates:
  - date: "2025-01-01"
    message: "Happy New Year!"
    actions:
      - "[ITEM] apple 64"

  - date: "*-01-01"
    message: "Happy New Year!"
    repeat: true
    repeat_time: 2

  - date: "*-*-14"
    message: "Happy 14th"
    repeat: false

  - date: "Thursday"
    message: "Crazy Thursday!"
    repeat: true
    repeat_time: 6

#########################################################
# Web API
# - External sign-in endpoint (WIP)
# - External query endpoints (status / total / streak etc.)
# - Protect with firewall or authentication to prevent abuse
# - enable_web_api: enable Web API
# - web_api_address: bind address
# - web_api_port: port
# - web_api_endpoint: base path
#########################################################
web_api:
  enable_web_api: false
  web_api_address: 0.0.0.0
  web_api_port: 7999
  web_api_endpoint: /api
